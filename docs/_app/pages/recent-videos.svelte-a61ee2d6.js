import{S as O,i as B,s as C,l as V,g as p,n as W,o as y,p as N,q as k,d as f,U as h,v as U,D as q,w as H,x as I,y as L,B as P,e as v,t as R,k as E,c as g,a as m,h as x,m as M,b as d,H as $,K as b,Q as A,R as S,f as F,I as D}from"../chunks/vendor-d20115e3.js";import{r as w,e as G,u as K,k as Q,c as Z,d as j}from"../chunks/stores-cf2b4674.js";import{V as z}from"../chunks/Videos-f1bbc380.js";import"../chunks/stores-7645a550.js";function J(i){let e,o;return e=new z({props:{videos:i[0],uname:null,showEachVideoUname:!0,title:"Recent Videos",$$slots:{default:[Y]},$$scope:{ctx:i}}}),{c(){H(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,r){L(e,t,r),o=!0},p(t,r){const u={};r&1&&(u.videos=t[0]),r&128&&(u.$$scope={dirty:r,ctx:t}),e.$set(u)},i(t){o||(k(e.$$.fragment,t),o=!0)},o(t){y(e.$$.fragment,t),o=!1},d(t){P(e,t)}}}function X(i){let e,o,t,r,u,a,n;return{c(){e=v("h1"),o=R("Recent Videos"),t=E(),r=v("div"),u=R("Fetching..."),a=E(),n=v("progress"),this.h()},l(s){e=g(s,"H1",{});var l=m(e);o=x(l,"Recent Videos"),l.forEach(f),t=M(s),r=g(s,"DIV",{class:!0});var c=m(r);u=x(c,"Fetching..."),c.forEach(f),a=M(s),n=g(s,"PROGRESS",{class:!0}),m(n).forEach(f),this.h()},h(){d(r,"class","align-center"),n.value=i[1],d(n,"class","svelte-108rn9f")},m(s,l){p(s,e,l),$(e,o),p(s,t,l),p(s,r,l),$(r,u),p(s,a,l),p(s,n,l)},p(s,l){l&2&&(n.value=s[1])},i:b,o:b,d(s){s&&f(e),s&&f(t),s&&f(r),s&&f(a),s&&f(n)}}}function Y(i){let e,o,t,r,u;return{c(){e=v("button"),o=A("svg"),t=A("path"),this.h()},l(a){e=g(a,"BUTTON",{title:!0});var n=m(e);o=S(n,"svg",{style:!0,viewBox:!0});var s=m(o);t=S(s,"path",{fill:!0,d:!0}),m(t).forEach(f),s.forEach(f),n.forEach(f),this.h()},h(){d(t,"fill","currentColor"),d(t,"d","M12 2A10 10 0 1 0 22 12A10 10 0 0 0 12 2M18 11H13L14.81 9.19A3.94 3.94 0 0 0 12 8A4 4 0 1 0 15.86 13H17.91A6 6 0 1 1 12 6A5.91 5.91 0 0 1 16.22 7.78L18 6Z"),F(o,"width","24px"),F(o,"height","24px"),d(o,"viewBox","0 0 24 24"),d(e,"title","refresh")},m(a,n){p(a,e,n),$(e,o),$(o,t),r||(u=D(e,"click",i[4]),r=!0)},p:b,d(a){a&&f(e),r=!1,u()}}}function ee(i){let e,o,t,r;const u=[X,J],a=[];function n(s,l){return s[0]==null?0:1}return e=n(i),o=a[e]=u[e](i),{c(){o.c(),t=V()},l(s){o.l(s),t=V()},m(s,l){a[e].m(s,l),p(s,t,l),r=!0},p(s,[l]){let c=e;e=n(s),e===c?a[e].p(s,l):(W(),y(a[c],1,1,()=>{a[c]=null}),N(),o=a[e],o?o.p(s,l):(o=a[e]=u[e](s),o.c()),k(o,1),o.m(t.parentNode,t))},i(s){r||(k(o),r=!0)},o(s){y(o),r=!1},d(s){a[e].d(s),s&&f(t)}}}function te(i,e,o){let t,r,u,a;h(i,w,c=>o(0,t=c)),h(i,G,c=>o(5,r=c)),h(i,K,c=>o(6,u=c));const n=q(0);h(i,n,c=>o(1,a=c));const s=async()=>{const c=new MessageChannel;navigator.serviceWorker.controller.postMessage({type:"INIT_PORT"},[c.port2]),c.port1.onmessage=_=>{_.data.type=="recentVideos"?w.set({data:_.data.payload.map(T=>T.video)}):_.data.type=="recentVideosProgress"?n.set(_.data.payload/Q):console.error("data.type not handled: ",_.data.type,_.data.payload)},r===null&&Z(await j(u.id)),navigator.serviceWorker.controller.postMessage({type:"FOLLOWS",payload:r})};return U(async()=>{t==null&&await s()}),[t,a,n,s,()=>{w.set(null),s()}]}class se extends O{constructor(e){super();B(this,e,te,ee,C,{})}}function oe(i){let e,o;return e=new se({}),{c(){H(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,r){L(e,t,r),o=!0},p:b,i(t){o||(k(e.$$.fragment,t),o=!0)},o(t){y(e.$$.fragment,t),o=!1},d(t){P(e,t)}}}class ie extends O{constructor(e){super();B(this,e,null,oe,C,{})}}export{ie as default};
