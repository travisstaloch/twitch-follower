var k=Object.defineProperty;var p=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var v=(t,e,s)=>e in t?k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,f=(t,e)=>{for(var s in e||(e={}))x.call(e,s)&&v(t,s,e[s]);if(p)for(var s of p(e))$.call(e,s)&&v(t,s,e[s]);return t};import{D as d,I as T,_ as I,$ as l}from"./vendor-d20115e3.js";const j=!0,y=(t,e)=>{const s=c=>JSON.stringify(c,null,2);localStorage.getItem(t)===null&&localStorage.setItem(t,s(e));const r=JSON.parse(localStorage.getItem(t)),{subscribe:a,set:o,update:g}=d(r);return{subscribe:a,set:c=>(localStorage.setItem(t,s(c)),o(c)),update:g}},S={oauth:"9qgyh0cztae6970iaelbq3i810fbj0",clientid:"eav60ifvqn9bzeuwucm522ddp6czja"},z=(t,e,s)=>s?t.replace("%{width}",e.width).replace("%{height}",e.height):t.replace("{width}",e.width).replace("{height}",e.height),E=t=>{const e=b()[0];return new Date(t).toLocaleString(e,{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone})},F=t=>{var e={year:"numeric",month:"2-digit",day:"numeric",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone};const s=b()[0];return new Date(t).toLocaleDateString(s,e)},U=t=>{const e=Math.abs(new Date-new Date(t)),s=Math.floor(e/36e5),r=Math.floor(e%36e5/6e4),a=Math.floor(e%6e4/1e3),o=new Date(0);return o.setHours(s,r,a),o.toTimeString().split(" ")[0]},n=async(t,e)=>await(await fetch(t,{headers:e})).json(),Z=10,A=async(t,e)=>{new Headers().append("Content-Type","application/json");const a=await(await fetch(t,{method:"POST",body:JSON.stringify(e)})).json();return console.log("postJson json",a),a};let _;const B=(t,e,s=1e3)=>{clearTimeout(_),_=setTimeout(()=>{e(t)},s)};function b(t={}){const s=f(f({},{languageCodeOnly:!1}),t),r=navigator.languages===void 0?[navigator.language]:navigator.languages;if(!!r)return r.map(a=>{const o=a.trim();return s.languageCodeOnly?o.split(/-|_/)[0]:o})}function V(t){return e=>{const s=Object.keys(t.$$.callbacks),r=[];return s.forEach(a=>r.push(T(e,a,o=>I(t,o)))),{destroy:()=>{r.forEach(a=>a())}}}}const J=()=>{try{return j&&window.matchMedia("(prefers-color-scheme: dark)").matches}catch{return!1}},D=t=>{let e=document.documentElement.attributes["data-theme"];e.value=t?"dark":"light"};window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{L(),D(q())});let u=null;const H=()=>{try{u=y("dark",J()),u.subscribe(t=>{localStorage.setItem("dark",JSON.stringify(t)),D(t)})}catch(t){console.error("initDark",t)}},L=()=>{u.update(t=>!t)},q=()=>l(u);let h=d(JSON.parse(localStorage.getItem("user"))||null);const P=()=>l(h),G=t=>h.set(t);h.subscribe(t=>{localStorage.user=JSON.stringify(t)});let w=d(null);const O=t=>w.set(t),i={Authorization:"Bearer "+S.oauth,"Client-Id":S.clientid},R=async t=>{let s=(await n(`https://api.twitch.tv/helix/users?login=${t}`,i)).data[0];return O(await m(s.id)),s},m=async t=>{const e=await n(`https://api.twitch.tv/helix/users/follows?first=100&from_id=${t}`,i);let s="";for(let a=0;a<e.data.length;++a){let o=e.data[a];s+=(a==0?"id=":"&id=")+o.to_id}const r=await n(`https://api.twitch.tv/helix/users?${s}`,i);for(let a=0;a<e.data.length;++a){let o=e.data[a];e.data[a].user=r.data.find(g=>g.id==o.to_id)}return e},W=async(t,e)=>await n(`https://api.twitch.tv/helix/videos?first=100&user_id=${t}&type=${e}`,i);let K=d(null);const C=async t=>await n(`https://api.twitch.tv/helix/streams?first=100&${t}`,i),Q=async t=>{const e=navigator.languages[0].substring(0,2);return console.log(t,e),await n(`https://api.twitch.tv/helix/streams?first=100&game_id=${t}&language=${e}`,i)},X=async t=>{let e="";const s=l(h);l(w)===null&&s&&s.id&&O(await m(s.id));let r=s&&s.id===t?l(w):await m(t);for(let a=0;a<r.data.length;++a){let o=r.data[a];e+=(a==0?"user_id=":"&user_id=")+o.to_id}return await C(e)};let Y=["most recent","least recent","most viewers","least viewers"],tt=[(t,e)=>new Date(e.started_at)-new Date(t.started_at),(t,e)=>new Date(t.started_at)-new Date(e.started_at),(t,e)=>e.viewer_count-t.viewer_count,(t,e)=>t.viewer_count-e.viewer_count];const et=(t,e)=>(t.data.sort((s,r)=>e(s,r)),t),st=y("settings",{external_program:{exec_server_url:"http://localhost:9000/exec",program:"runstreamlink.sh"}}),at=async t=>await n("https://api.twitch.tv/helix/games/top?first=100",i),rt=async t=>t?await n(`https://api.twitch.tv/helix/search/categories?first=100&query=${t}`,i):null;export{i as A,rt as B,Q as C,at as D,q as a,P as b,O as c,m as d,w as e,R as f,V as g,F as h,H as i,B as j,Z as k,z as l,E as m,st as n,et as o,A as p,X as q,K as r,G as s,L as t,h as u,Y as v,tt as w,U as x,W as y,n as z};
