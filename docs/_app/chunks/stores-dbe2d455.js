import{Z as n,D as c}from"./vendor-611aba13.js";let f=(t,e)=>{};const v=()=>{f=(t,e)=>{if(!localStorage)return;const s=u=>JSON.stringify(u,null,2);localStorage.getItem(t)===null&&localStorage.setItem(t,s(e));const r=JSON.parse(localStorage.getItem(t)),{subscribe:a,set:i,update:d}=c(r);return{subscribe:a,set:u=>(localStorage.setItem(t,s(u)),i(u)),update:d}}};let h=null;const S=()=>{try{h=f("dark",k()),h.subscribe(t=>{localStorage.setItem("dark",JSON.stringify(t)),m(t)})}catch(t){console.error("initDark",t)}},y=()=>{h.update(t=>!t)},x=()=>n(h);let l=c(null);const I=()=>n(l),J=t=>l.set(t);let w=c(null);const p=t=>w.set(t),k=()=>{try{return window&&window.matchMedia("(prefers-color-scheme: dark)").matches}catch{return!1}},m=t=>{if(!document)return;let e=document.documentElement.attributes["data-theme"];e.value=t?"dark":"light"};let _=c(null);const D=()=>{v(),_=f("settings",{external_program:{exec_server_url:"http://localhost:9000/exec",program:"runstreamlink.sh"},twitch_proxy_api:{url:"http://localhost:9000/api/twitch"}}),S(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{y(),m(x())}),l.set(JSON.parse(localStorage.getItem("user"))),l.subscribe(e=>{localStorage.user=JSON.stringify(e)})},o=async t=>{const e=n(_);return e||D(),await(await fetch(`${e.twitch_proxy_api.url}?url=${encodeURIComponent(t)}`)).json()},N=async t=>{let s=(await o(`https://api.twitch.tv/helix/users?login=${t}`)).data[0];return p(await g(s.id)),s},g=async t=>{const e=await o(`https://api.twitch.tv/helix/users/follows?first=100&from_id=${t}`);let s="";for(let a=0;a<e.data.length;++a){let i=e.data[a];s+=(a==0?"id=":"&id=")+i.to_id}const r=await o(`https://api.twitch.tv/helix/users?${s}`);for(let a=0;a<e.data.length;++a){let i=e.data[a];e.data[a].user=r.data.find(d=>d.id==i.to_id)}return e},O=async(t,e)=>await o(`https://api.twitch.tv/helix/videos?first=100&user_id=${t}&type=${e}`);let U=c(null);const $=async t=>await o(`https://api.twitch.tv/helix/streams?first=100&${t}`),q=async t=>{const e=navigator.languages[0].substring(0,2);return await o(`https://api.twitch.tv/helix/streams?first=100&game_id=${t}&language=${e}`)},L=async t=>{let e="";const s=n(l);n(w)===null&&s&&s.id&&p(await g(s.id));let r=s&&s.id===t?n(w):await g(t);for(let a=0;a<r.data.length;++a){let i=r.data[a];e+=(a==0?"user_id=":"&user_id=")+i.to_id}return await $(e)};let T=["most recent","least recent","most viewers","least viewers"],j=[(t,e)=>new Date(e.started_at)-new Date(t.started_at),(t,e)=>new Date(t.started_at)-new Date(e.started_at),(t,e)=>e.viewer_count-t.viewer_count,(t,e)=>t.viewer_count-e.viewer_count];const C=(t,e)=>(t.data.sort((s,r)=>e(s,r)),t),E=async t=>await o("https://api.twitch.tv/helix/games/top?first=100"),F=async t=>t?await o(`https://api.twitch.tv/helix/search/categories?first=100&query=${t}`):null;export{D as a,I as b,w as c,p as d,g as e,N as f,x as g,_ as h,C as i,T as j,j as k,L as l,O as m,o as n,F as o,q as p,E as q,U as r,J as s,y as t,l as u};
